(this.webpackJsonpfft_frontend=this.webpackJsonpfft_frontend||[]).push([[0],{381:function(e,t,a){e.exports=a(551)},551:function(e,t,a){"use strict";a.r(t);var n=a(4),r=a.n(n),o=a(96),c=a.n(o),l=a(135),i=a(334),s=a(336),u=a(57),d=a.n(u),m=a(88),p=a(122),f=a.n(p),v=function(){var e=Object(m.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/countries");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_COUNTRYCODES":return t.payload;default:return e}},g=a(273),b={getImports:function(){var e=Object(m.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/imports/".concat(t));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getExports:function(){var e=Object(m.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/exports/".concat(t));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getTradeBalance:function(){var e=Object(m.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/tradebalance");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getSitc2Data:function(){var e=Object(m.a)(d.a.mark((function e(t,a){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/SITC2/".concat(a,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),getSitc2CountryData:function(){var e=Object(m.a)(d.a.mark((function e(t,a,n){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/SITC2/".concat(t,"/").concat(a,"/").concat(n[0].code));case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{flow:"exports"},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_TRADEDATA":return Object(g.a)({},e,{exportsData:t.exportsData,importsData:t.importsData,tradeBalance:t.tradeBalance,sitc2Data:t.sitc2Data});case"SET_FLOW":return Object(g.a)({},e,{flow:t.flow});default:return e}},E=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_MODE":return!e;default:return e}},x=Object(l.combineReducers)({tradeData:y,countryCodes:h,darkModeActive:E}),w=Object(l.createStore)(x,Object(i.composeWithDevTools)(Object(l.applyMiddleware)(s.a))),k=a(136),O=a(73),j=a(175),C=a.n(j),D=a(564),T=a(562),S=a(568),A=a(572),F=a(569),I=a(160),N=a(565),M=a(571),R=function(e){var t=e.country,a=e.tradeData,n=e.flow;return r.a.createElement(N.a,{inverted:!0,basic:!0,compact:!0,celled:!0,selectable:!0,singleLine:!0},r.a.createElement(N.a.Header,null,r.a.createElement(N.a.Row,null,r.a.createElement(N.a.HeaderCell,{colSpan:"2",textAlign:"center"},r.a.createElement(M.a,{as:"h3",style:{color:"#fff"}},"Finland ",n," ",t[0].name)))),r.a.createElement(N.a.Body,null,a.slice(0,10).map((function(e){return r.a.createElement(N.a.Row,{key:e.group},r.a.createElement(N.a.Cell,null,e.group),r.a.createElement(N.a.Cell,null,e.value," \u20ac"))}))))},B=function(e){var t=e.country,a=e.setCountry,o=e.setCountryFilter,c=e.year,l=Object(n.useState)([]),i=Object(O.a)(l,2),s=i[0],u=i[1],d=Object(n.useState)([]),m=Object(O.a)(d,2),p=m[0],f=m[1];return Object(n.useEffect)((function(){b.getSitc2CountryData("imports",c,t).then((function(e){u(e.data)})),b.getSitc2CountryData("exports",c,t).then((function(e){f(e.data)}))}),[t,c]),0===t.length?null:0===s.length&&0===p.length?r.a.createElement(S.a,{active:!0},r.a.createElement(T.a,null)):r.a.createElement(A.a,{container:!0,stackable:!0,relaxed:!0},r.a.createElement(F.a,{icon:!0,circular:!0,onClick:function(){o(""),a([])},style:{position:"absolute",top:"1em",left:"1em"}},r.a.createElement(I.a,{name:"angle left",size:"large"})),r.a.createElement(A.a.Row,{columns:2},r.a.createElement(A.a.Column,null,r.a.createElement(R,{country:t,tradeData:s,flow:"imported from"})),r.a.createElement(A.a.Column,null,r.a.createElement(R,{country:t,tradeData:p,flow:"exported to"}))))},L=a(567),P=a(237),_=a.n(P),z=function(e){var t=e.handleCountryFilterChange,a=e.countryCodes,o=Object(n.useState)(""),c=Object(O.a)(o,2),l=c[0],i=c[1],s=Object(n.useState)(!1),u=Object(O.a)(s,2),d=u[0],m=u[1],p=Object(n.useState)([]),f=Object(O.a)(p,2),v=f[0],h=f[1];if(void 0===a)return null;var g=a.map((function(e){return{title:e.name,key:e.code}}));return r.a.createElement(L.a,{placeholder:"Search...",loading:d,onResultSelect:function(e,a){var n=a.result;i(n.title),t(n.title)},onSearchChange:_.a.debounce((function(e,a){var n=a.value;if(m(!0),i(n),m(!0),i(n),n.length<1)return i(""),m(!1),void h([]);var r=new RegExp(_.a.escapeRegExp(n),"i");m(!1);var o=_.a.filter(g,(function(e){return r.test(e.title)}));o.length>20?h([{title:"Please narrow down your search."}]):h(o),1===v.length&&t(v[0].title)}),500,{leading:!0}),results:v,resultRenderer:function(e){var t=e.title;return r.a.createElement("div",null,t)},value:l})},H=a(570),Y=function(e){var t=e.darkModeActive;return r.a.createElement(H.a,{secondary:!0,className:t?"footer inverted dark-mode":"footer"},r.a.createElement(H.a.Item,{link:!0,as:"a",href:"https://github.com/joonaspartanen/finnish-foreign-trade"},"About"))},G=function(e){var t=e.flow,a=e.setFlow,n="exports"===t;return r.a.createElement("div",{style:{position:"absolute",bottom:"2em",left:"2em",zIndex:"1"}},r.a.createElement(F.a.Group,null,r.a.createElement(F.a,{toggle:!0,active:n,content:"Exports",onClick:function(e){n||a("exports")}}),r.a.createElement(F.a,{toggle:!0,active:!n,content:"Imports",onClick:function(e){n&&a("imports")}})))},W=a(344),U=a(63),Z=a(176),J=a(356),X=function(e){var t=e.imports,a=e.exports,o=e.flow,c=Object(n.useRef)(null);return U.e(J.a),Object(n.useEffect)((function(){var e=U.d("mapdiv",Z.a);e.geodata=W.a,e.projection=new Z.d.Mercator,e.zoomControl=new Z.c,e.backgroundSeries.mapPolygons.template.polygon.fill=U.b("#EEE"),e.backgroundSeries.mapPolygons.template.polygon.fillOpacity=1,e.chartContainer.wheelable=!1,window.innerHeight>window.innerWidth?(e.homeZoomLevel=5,e.minZoomLevel=5):(e.homeZoomLevel=2,e.minZoomLevel=2),e.homeGeoPoint={latitude:50,longitude:11},e.maxPanOut=0;var n=function(e){var n="exports"===e?"#5E5B78":"#C17D80",o=new Z.b;return o.name=e.charAt(0).toUpperCase()+e.slice(1),o.id=e,o.heatRules.push({property:"fill",target:o.mapPolygons.template,min:U.b(n).brighten(1.2),max:U.b(n).brighten(-.4)}),o.useGeodata=!0,o.exclude=["AQ","SJ"],o.data="exports"===e?a:t,o.tooltip.getFillFromObject=!1,o.tooltip.background.fill=U.b("#333"),o.tooltip.background.fillOpacity=.8,o.mapPolygons.template.tooltipHTML="\n      <div>\n        Total ".concat("exports"===e?"exports from Finland to {name}":"imports from {name} to Finland"," ({year.formatNumber('#')}):\n        <br>\n        {euros} \u20ac\n      </div>\n      "),o.tooltip.label.interactionsEnabled=!0,o.mapPolygons.template.nonScalingStroke=!0,o.mapPolygons.template.strokeWidth=.5,o.mapPolygons.template.states.create("hover").properties.fill=U.b("#555"),r(o),o},r=function(t){e.events.on("ready",(function(){var e=t.getPolygonById("FI");e.fill=U.b("#FFF"),e.tooltipText="",e.tooltipHTML=null,e.hoverable=!1}))},o=n("exports"),l=n("imports");return l.hidden=!0,e.series.push(o),e.series.push(l),c.current=e,function(){e.dispose()}}),[t,a]),Object(n.useEffect)((function(){var e=c.current.series.getIndex(0),t=c.current.series.getIndex(1);"exports"===o?(e.show(),t.hide()):(t.show(),e.hide())}),[o]),r.a.createElement("div",{id:"mapdiv",style:{width:"100%",height:"100%",overflow:"hidden"}})},Q=function(e){var t=e.imports,a=e.exports,o=(e.year,Object(n.useState)("exports")),c=Object(O.a)(o,2),l=c[0],i=c[1];return void 0===t||void 0===a?r.a.createElement(S.a,{active:!0},r.a.createElement(T.a,null)):r.a.createElement(r.a.Fragment,null,r.a.createElement(G,{flow:l,setFlow:i}),r.a.createElement(X,{imports:t,exports:a,flow:l}))},V=a(566),q=a(563),K=function(e){var t=e.year,a=e.setYear,n=e.darkModeActive,o=Object(k.b)();return r.a.createElement(H.a,{as:"nav",stackable:!0,size:"large",className:n?"navbar dark-mode":"navbar"},r.a.createElement(H.a.Item,{header:!0},"Finnish Foreign Trade Visualized"),r.a.createElement(H.a.Item,{link:!0,as:"a",href:"#trade-map"},"Trade Map"),r.a.createElement(H.a.Item,{link:!0,as:"a",href:"#trade-balance"},"Trade Balance"),r.a.createElement(H.a.Item,{link:!0,as:"a",href:"#imports-by-product"},"By product group"),r.a.createElement(H.a.Item,{link:!0,as:"a",href:"#trade-partners"},"By trade partner"),r.a.createElement(H.a.Item,null,r.a.createElement(V.a,{onChange:function(e,t){var n=t.value;return a(n)},options:[{key:2019,text:"2019",value:2019},{key:2018,text:"2018",value:2018},{key:2017,text:"2017",value:2017},{key:2016,text:"2016",value:2016},{key:2015,text:"2015",value:2015},{key:2014,text:"2014",value:2014},{key:2013,text:"2013",value:2013},{key:2012,text:"2012",value:2012}],placeholder:"Year",selection:!0,value:t})),r.a.createElement(H.a.Item,{className:"color-mode-toggle"},r.a.createElement(I.a,{name:"moon"}),r.a.createElement(q.a,{onChange:function(){return o((function(e){e({type:"CHANGE_MODE"})}))},toggle:!0}),r.a.createElement(I.a,{name:"sun"})))},$=a(238),ee=a(357),te=a(358),ae=function(e){var t=e.sitc2Data,a=e.flow,o=e.year,c=Object(n.useRef)(null);return U.e(ee.a),U.e(te.a),Object(n.useEffect)((function(){var e=U.d("products-treemap-div",$.b);e.responsive.enabled=!0,e.data=t.exports,e.dataFields.value="value",e.dataFields.name="group",e.dataFields.children="children";var a=e.seriesTemplates.create("1"),n=a.columns.template;return n.tooltipText="{group}: {value} \u20ac",a.tooltip.pointerOrientation="down",e.legend=new $.a,e.legend.position="bottom",e.legend.paddingTop=20,e.legend.itemContainers.template.tooltipText="{group}",e.legend.labels.template.text="",e.seriesTemplates.create("0").columns.template.states.create("hover").adapter.add("fill",(function(e){return U.b(U.c.brighten(e.rgb,-.2))})),n.states.create("hover").adapter.add("fill",(function(e){return U.b(U.c.brighten(e.rgb,-.2))})),e.maxLevels=1,e.responsive.rules.push({relevant:U.a.widthXL,state:function(e,t){if(e instanceof $.a){var a=e.states.create(t);return a.sprite.itemContainers.template.clickable=!1,a.sprite.itemContainers.template.focusable=!1,a}return null}}),c.current=e,function(){e.dispose()}}),[t]),Object(n.useEffect)((function(){c.current.data=t[a]}),[t,a]),r.a.createElement("div",{style:{width:"100%",height:"100vh",paddingTop:"3em",paddingRight:"10vw",paddingLeft:"10vw",textAlign:"center"}},r.a.createElement(M.a,{inverted:!0,as:"h3"},"Finnish ",a," by product category (",o,")"),r.a.createElement("div",{id:"products-treemap-div",style:{width:"100%",height:"90%"}}))},ne=function(e){var t=e.sitc2Data,a=e.year,o=Object(n.useState)("exports"),c=Object(O.a)(o,2),l=c[0],i=c[1];return void 0===t?r.a.createElement(S.a,{active:!0},r.a.createElement(T.a,null)):r.a.createElement(r.a.Fragment,null,r.a.createElement(G,{flow:l,setFlow:i}),r.a.createElement(ae,{sitc2Data:t,flow:l,year:a}))},re=a(60),oe=function(e){var t=e.tradeBalance,a=Object(n.useRef)();return Object(n.useEffect)((function(){if(t){var e=80,n=40,r=80,o=40,c=20,l=10,i=20,s=10,u=window.innerWidth-n-o,d=window.innerHeight-e-r,m=["imports","exports"],p={imports:"Total value of goods imported to Finland",exports:"Total value of goods exported from Finland"},f=re.j().range(["#58556d","#743033"]),v=Math.max(re.f(t.map((function(e){return e.imports}))),re.f(t.map((function(e){return e.exports})))),h=re.k(a.current),g=h.append("svg").attr("width",u+l+s).attr("height",d+c+i).attr("viewBox","0 0 ".concat(u+l+s," ").concat(d+c+i));!function(){var a=re.h().domain(t.map((function(e){return e.year})).sort((function(e,t){return e-t}))).rangeRound([o,u-n]).paddingInner(.1),c=re.h().domain(m).rangeRound([0,a.bandwidth()]).padding(.05),p=re.i().domain([0,v]).nice().rangeRound([d-e,e]);g.append("g").call((function(e){return e.attr("transform","translate(0, ".concat(d-r+i,")")).call(re.a(a).tickSize(0)).style("color","#fff").call((function(e){return e.select(".domain").remove()})).selectAll("text")})),g.append("g").call((function(e){return e.attr("transform","translate(".concat(o,", 0)")).call(re.b(p).ticks(null,"s").tickSizeInner(0)).style("color","#fff").call((function(e){return e.select(".domain").remove()}))})),g.append("g").attr("class","grid").call(re.b(p).tickSize(-u+n+l+20).tickFormat("")).attr("transform","translate(".concat(o+s,", 0)")),g.append("g").selectAll("g").data(t).join("g").attr("transform",(function(e){return"translate(".concat(a(e.year)+s,", 0)")})).selectAll("rect").data((function(e){return m.map((function(t){return{key:t,value:e[t]}}))})).join("rect").attr("class","bar").attr("x",(function(e){return c(e.key)})).attr("width",c.bandwidth()).attr("y",(function(e){return p(0)})).transition().ease(re.c).duration(1500).attr("y",(function(e){return p(e.value)})).attr("height",(function(e){return p(0)-p(e.value)})).attr("fill",(function(e){return f(e.key)}))}(),g.selectAll(".bar").on("mouseover",(function(e){re.k(this).style("fill",re.g(f(e.key)).darker(1))})).on("mouseout",(function(e){re.k(this).style("fill",f(e.key))})).on("mouseover",(function(e){var t="\n        <div>\n          Total ".concat(e.key," from Finland:\n          <br>\n          ").concat(re.e(",")(e.value),"\n        \u20ac</div>\n        ");y(b,t)})).on("mousemove",(function(){return E(b)})).on("mouseout",(function(){b.style("display","none")}));var b=re.k("body").append("div").attr("class","d3-tooltip"),y=function(e,t){e.style("display","block"),e.html(t)},E=function(e){e.style("left","".concat(re.d.pageX+5,"px")).style("top","".concat(re.d.pageY-65,"px"))},x=h.append("svg").attr("width",300).attr("height",40).attr("class","legend-wrapper").selectAll(".legend").data(m).enter().append("g").attr("class","legend").attr("transform",(function(e,t){return"translate(".concat(140*t,", 0)")}));return x.append("rect").attr("x",0).attr("y",0).attr("width",40).attr("height",40).style("fill",(function(e){return f(e)})).on("mouseover",(function(e){var t="<div>".concat(p[e],"</div>");y(b,t)})).on("mousemove",(function(){return E(b)})).on("mouseout",(function(){b.style("display","none")})),x.append("text").attr("x",0).attr("y",0).attr("transform",(function(e){return"translate(50, 25)"})).attr("class","d3-legend-text").style("fill","#fff").text((function(e){return e.toUpperCase()})),function(){h.selectAll("*").remove()}}}),[t]),Object(n.useEffect)((function(){t&&console.log("trade data updated")}),[t]),r.a.createElement("div",{style:{width:"100%",height:"100vh",paddingTop:"3em",textAlign:"center"}},r.a.createElement(M.a,{inverted:!0,as:"h3"},"Finnish Trade Balance"),r.a.createElement("div",{ref:a}))},ce=function(){var e=Object(k.b)(),t=Object(n.useState)(2019),a=Object(O.a)(t,2),o=a[0],c=a[1],l=Object(n.useState)([]),i=Object(O.a)(l,2),s=i[0],u=i[1],p=Object(n.useState)(""),f=Object(O.a)(p,2),h=f[0],g=f[1],y=Object(k.c)((function(e){return e})),E=y.tradeData;return Object(n.useEffect)((function(){e(function(e){return function(){var t=Object(m.a)(d.a.mark((function t(a){var n,r,o,c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.getExports(e);case 2:return n=t.sent,t.next=5,b.getImports(e);case 5:return r=t.sent,t.next=8,b.getTradeBalance();case 8:return o=t.sent,t.next=11,b.getSitc2Data(e,"total");case 11:c=t.sent,a({type:"INIT_TRADEDATA",exportsData:n,importsData:r,tradeBalance:o,sitc2Data:c});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(o)),e(function(){var e=Object(m.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v();case 2:a=e.sent,t({type:"INIT_COUNTRYCODES",payload:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[o,e]),r.a.createElement("div",{className:y.darkModeActive?"main-container dark-mode":"main-container"},r.a.createElement(D.a,{fluid:!0},r.a.createElement(K,{year:o,setYear:c,darkModeActive:y.darkModeActive}),(void 0===E.importsData||void 0===E.exportsData)&&r.a.createElement("div",{style:{height:"100vh"}},r.a.createElement(T.a,{active:!0})),void 0!==E.importsData&&void 0!==E.exportsData&&r.a.createElement("div",null,r.a.createElement(C.a,{id:"trade-map"},r.a.createElement("section",{className:y.darkModeActive?"chart-section dark-mode":"chart-section"},r.a.createElement(Q,{imports:E.importsData,exports:E.exportsData}),r.a.createElement("a",{href:"#trade-balance",className:"anchor-link"},r.a.createElement("div",{className:"arrow-down"})))),r.a.createElement(C.a,{id:"trade-balance"},r.a.createElement("section",{className:y.darkModeActive?"chart-section dark-mode":"chart-section"},r.a.createElement(oe,{tradeBalance:E.tradeBalance}),r.a.createElement("a",{href:"#imports-by-product",className:"anchor-link"},r.a.createElement("div",{className:"arrow-down"})))),r.a.createElement(C.a,{id:"imports-by-product"},r.a.createElement("section",{className:y.darkModeActive?"chart-section dark-mode":"chart-section"},r.a.createElement(ne,{sitc2Data:E.sitc2Data,year:o}),r.a.createElement("a",{href:"#trade-partners",className:"anchor-link"},r.a.createElement("div",{className:"arrow-down"})))),r.a.createElement(C.a,{id:"trade-partners"},r.a.createElement("section",{className:y.darkModeActive?"chart-section dark-mode":"chart-section"},0===s.length&&r.a.createElement(z,{countryFilter:h,handleCountryFilterChange:function(e){g(e);var t=y.countryCodes.filter((function(t){return t.name===e}));u(t)},countryCodes:y.countryCodes}),0!==s.length&&r.a.createElement(B,{country:s,setCountry:u,setCountryFilter:g,year:o})))),r.a.createElement(Y,{darkModeActive:y.darkModeActive})))};c.a.render(r.a.createElement(k.a,{store:w},r.a.createElement(ce,null)),document.getElementById("root"))}},[[381,1,3]]]);
//# sourceMappingURL=main.4ac2b10d.chunk.js.map