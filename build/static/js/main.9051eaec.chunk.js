(this.webpackJsonpfft_frontend=this.webpackJsonpfft_frontend||[]).push([[0],{381:function(e,t,a){e.exports=a(552)},552:function(e,t,a){"use strict";a.r(t);var n=a(4),r=a.n(n),o=a(96),c=a.n(o),l=a(135),i=a(334),s=a(336),u=a(53),d=a.n(u),m=a(84),p=a(122),f=a.n(p),v=function(){var e=Object(m.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/countries");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"START_LOADING":return!0;case"FINISH_LOADING":return!1;default:return e}},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_COUNTRYCODES":return t.payload;default:return e}},y=a(273),b={getImports:function(){var e=Object(m.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/imports/".concat(t));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getExports:function(){var e=Object(m.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/exports/".concat(t));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getTradeBalance:function(){var e=Object(m.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/tradebalance");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getSitc2Data:function(){var e=Object(m.a)(d.a.mark((function e(t,a){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/SITC2/".concat(a,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),getSitc2CountryData:function(){var e=Object(m.a)(d.a.mark((function e(t,a,n){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/SITC2/".concat(t,"/").concat(a,"/").concat(n.code));case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_TRADEDATA":return Object(y.a)({},e,{exportsData:t.exportsData,importsData:t.importsData,sitc2Data:t.sitc2Data});case"INIT_TRADE_BALANCE_DATA":return Object(y.a)({},e,{tradeBalance:t.tradeBalance});default:return e}},x=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_MODE":return!e;default:return e}},w=Object(l.combineReducers)({tradeData:E,countryCodes:g,darkModeActive:x,isLoading:h}),k=Object(l.createStore)(w,Object(i.composeWithDevTools)(Object(l.applyMiddleware)(s.a))),O=a(136),A=a(73),j=a(175),I=a.n(j),T=a(565),D=a(563),C=a(569),N=a(573),S=a(570),F=a(160),R=a(566),M=a(572),L=function(e){var t=e.country,a=e.tradeData,n=e.flow;return 0===a.length?r.a.createElement("div",null,"No data available"):r.a.createElement(R.a,{inverted:!0,basic:!0,compact:!0,celled:!0,selectable:!0,singleLine:!0},r.a.createElement(R.a.Header,null,r.a.createElement(R.a.Row,null,r.a.createElement(R.a.HeaderCell,{colSpan:"2",textAlign:"center"},r.a.createElement(M.a,{as:"h3",style:{color:"#fff"}},"Finland ","exports"===n?" exported to ":" imported from "," ",t.name)))),r.a.createElement(R.a.Body,null,a.map((function(e){return r.a.createElement(R.a.Row,{key:e.group},r.a.createElement(R.a.Cell,null,e.group),r.a.createElement(R.a.Cell,null,e.value," \u20ac"))}))))},_=function(e){var t=e.country,a=e.setCountry,o=e.setCountryFilter,c=e.year,l=Object(n.useState)([]),i=Object(A.a)(l,2),s=i[0],u=i[1],d=Object(n.useState)([]),m=Object(A.a)(d,2),p=m[0],f=m[1],v=function(e){return e.slice(0,10).filter((function(e){return null!==e.value}))};return Object(n.useEffect)((function(){b.getSitc2CountryData("imports",c,t).then((function(e){u(e.data)})),b.getSitc2CountryData("exports",c,t).then((function(e){f(e.data)}))}),[t,c]),""===t?null:0===s.length&&0===p.length?r.a.createElement(C.a,{active:!0},r.a.createElement(D.a,null)):r.a.createElement(N.a,{container:!0,stackable:!0,relaxed:!0,style:{paddingTop:"3em"}},r.a.createElement(S.a,{icon:!0,circular:!0,onClick:function(){o(""),a([])},style:{position:"absolute",top:"1em",left:"1em"}},r.a.createElement(F.a,{name:"angle left",size:"large"})),r.a.createElement("img",{className:"flag",src:"https://www.countryflags.io/".concat(t.code,"/flat/64.png"),alt:"Flag of ".concat(t.name)}),r.a.createElement(N.a.Row,{columns:2},r.a.createElement(N.a.Column,null,r.a.createElement(L,{country:t,tradeData:v(p),flow:"exports"})),r.a.createElement(N.a.Column,null,r.a.createElement(L,{country:t,tradeData:v(s),flow:"imports"}))))},B=a(568),G=a(238),H=a.n(G),z=function(e){var t=e.handleCountryFilterChange,a=e.countryCodes,o=Object(n.useState)(""),c=Object(A.a)(o,2),l=c[0],i=c[1],s=Object(n.useState)(!1),u=Object(A.a)(s,2),d=u[0],m=u[1],p=Object(n.useState)([]),f=Object(A.a)(p,2),v=f[0],h=f[1];if(void 0===a)return null;var g=a.map((function(e){return{title:e.name,key:e.code}}));return r.a.createElement(B.a,{placeholder:"Search...",loading:d,onResultSelect:function(e,a){var n=a.result;i(n.title),t(n.title)},onSearchChange:H.a.debounce((function(e,a){var n=a.value;if(m(!0),i(n),m(!0),i(n),n.length<1)return i(""),m(!1),void h([]);var r=new RegExp(H.a.escapeRegExp(n),"i");m(!1);var o=H.a.filter(g,(function(e){return r.test(e.title)}));o.length>20?h([{title:"Please narrow down your search."}]):h(o),1===v.length&&t(v[0].title)}),500,{leading:!0}),results:v,resultRenderer:function(e){var t=e.title;return r.a.createElement("div",null,t)},value:l})},P=a(571),Y=function(e){var t=e.darkModeActive;return r.a.createElement(P.a,{secondary:!0,className:t?"footer inverted dark-mode":"footer"},r.a.createElement(P.a.Item,{link:!0,as:"a",href:"https://github.com/joonaspartanen/finnish-foreign-trade"},"About"))},W=function(e){var t=e.flow,a=e.setFlow,n="exports"===t;return r.a.createElement("div",{style:{position:"absolute",bottom:"2em",left:"2em",zIndex:"1"}},r.a.createElement(S.a.Group,null,r.a.createElement(S.a,{toggle:!0,active:n,content:"Exports",onClick:function(e){n||a("exports")}}),r.a.createElement(S.a,{toggle:!0,active:!n,content:"Imports",onClick:function(e){n&&a("imports")}})))},U=a(344),Z=a(63),J=a(176),X=a(356),Q=function(e){var t=e.imports,a=e.exports,o=e.flow,c=Object(n.useRef)(null);return Z.e(X.a),Object(n.useEffect)((function(){var e=Z.d("mapdiv",J.a);e.geodata=U.a,e.projection=new J.d.Mercator,e.zoomControl=new J.c,e.backgroundSeries.mapPolygons.template.polygon.fill=Z.b("#eee"),e.backgroundSeries.mapPolygons.template.polygon.fillOpacity=1,e.chartContainer.wheelable=!1,window.innerHeight>window.innerWidth?(e.homeZoomLevel=5,e.minZoomLevel=5):(e.homeZoomLevel=2,e.minZoomLevel=2),e.homeGeoPoint={latitude:50,longitude:11},e.maxPanOut=0;var n=function(e){var n="exports"===e?"#18447e":"#a01c0c",o=new J.b;return o.name=e.charAt(0).toUpperCase()+e.slice(1),o.id=e,o.heatRules.push({property:"fill",target:o.mapPolygons.template,min:Z.b(n).brighten(2.4),max:Z.b(n).brighten(-.4)}),o.useGeodata=!0,o.exclude=["AQ","SJ"],o.data="exports"===e?a:t,o.tooltip.getFillFromObject=!1,o.tooltip.background.fill=Z.b("#333"),o.tooltip.background.fillOpacity=.9,o.mapPolygons.template.tooltipHTML="\n      <div>\n        Total ".concat("exports"===e?"exports from Finland to {name}":"imports from {name} to Finland"," ({year.formatNumber('#')}):\n        <br>\n        {euros} \u20ac\n      </div>\n      "),o.tooltip.label.interactionsEnabled=!0,o.mapPolygons.template.nonScalingStroke=!0,o.mapPolygons.template.strokeWidth=.5,o.mapPolygons.template.states.create("hover").properties.fill=Z.b("#666"),r(o),o},r=function(t){e.events.on("ready",(function(){var e=t.getPolygonById("FI");e.fill=Z.b("#FFF"),e.tooltipText="",e.tooltipHTML=null,e.hoverable=!1}))},o=n("exports"),l=n("imports");return l.hidden=!0,e.series.push(o),e.series.push(l),c.current=e,function(){e.dispose()}}),[t,a]),Object(n.useEffect)((function(){var e=c.current.series.getIndex(0),t=c.current.series.getIndex(1);"exports"===o?(e.show(),t.hide()):(t.show(),e.hide())}),[o]),r.a.createElement("div",{id:"mapdiv",style:{width:"100%",height:"100%",overflow:"hidden"}})},V=function(e){var t=e.imports,a=e.exports,o=Object(n.useState)("exports"),c=Object(A.a)(o,2),l=c[0],i=c[1];return void 0===t||void 0===a?r.a.createElement(C.a,{active:!0},r.a.createElement(D.a,null)):r.a.createElement(r.a.Fragment,null,r.a.createElement(W,{flow:l,setFlow:i}),r.a.createElement(Q,{imports:t,exports:a,flow:l}))},q=a(567),K=a(564),$=function(e){var t=e.year,a=e.setYear,n=e.darkModeActive,o=Object(O.b)();return r.a.createElement(P.a,{as:"nav",stackable:!0,size:"large",className:n?"navbar dark-mode":"navbar"},r.a.createElement(P.a.Item,{header:!0},"Finnish Foreign Trade Visualized"),r.a.createElement(P.a.Item,{link:!0,as:"a",href:"#trade-map"},"Trade Map"),r.a.createElement(P.a.Item,{link:!0,as:"a",href:"#trade-balance"},"Trade Balance"),r.a.createElement(P.a.Item,{link:!0,as:"a",href:"#imports-by-product"},"By product group"),r.a.createElement(P.a.Item,{link:!0,as:"a",href:"#trade-partners"},"By trade partner"),r.a.createElement(P.a.Item,null,r.a.createElement(q.a,{onChange:function(e,t){var n=t.value;return a(n)},options:[{key:2019,text:"2019",value:2019},{key:2018,text:"2018",value:2018},{key:2017,text:"2017",value:2017},{key:2016,text:"2016",value:2016},{key:2015,text:"2015",value:2015},{key:2014,text:"2014",value:2014},{key:2013,text:"2013",value:2013},{key:2012,text:"2012",value:2012}],placeholder:"Year",selection:!0,value:t})),r.a.createElement(P.a.Item,{className:"color-mode-toggle"},r.a.createElement(F.a,{name:"moon"}),r.a.createElement(K.a,{onChange:function(){return o((function(e){e({type:"CHANGE_MODE"})}))},toggle:!0}),r.a.createElement(F.a,{name:"sun"})))},ee=a(239),te=a(357),ae=a(358),ne=function(e){var t=e.sitc2Data,a=e.flow,o=e.year,c=Object(n.useRef)(null);return Z.e(te.a),Z.e(ae.a),Object(n.useEffect)((function(){var e=Z.d("products-treemap-div",ee.b);e.responsive.enabled=!0,e.data=t.exports,e.dataFields.value="value",e.dataFields.name="group",e.dataFields.children="children";var a=e.seriesTemplates.create("1"),n=a.columns.template;return n.tooltipText="{group}: {value} \u20ac",a.tooltip.pointerOrientation="down",e.legend=new ee.a,e.legend.position="bottom",e.legend.paddingTop=20,e.legend.itemContainers.template.tooltipText="{group}",e.legend.labels.template.text="",e.seriesTemplates.create("0").columns.template.states.create("hover").adapter.add("fill",(function(e){return Z.b(Z.c.brighten(e.rgb,-.2))})),n.states.create("hover").adapter.add("fill",(function(e){return Z.b(Z.c.brighten(e.rgb,-.2))})),e.maxLevels=1,e.responsive.rules.push({relevant:Z.a.widthXL,state:function(e,t){if(e instanceof ee.a){var a=e.states.create(t);return a.sprite.itemContainers.template.clickable=!1,a.sprite.itemContainers.template.focusable=!1,a}return null}}),c.current=e,function(){e.dispose()}}),[t]),Object(n.useEffect)((function(){c.current.data=t[a]}),[t,a]),r.a.createElement("div",{style:{width:"100%",height:"100vh",paddingTop:"3em",paddingRight:"10vw",paddingLeft:"10vw",textAlign:"center"}},r.a.createElement(M.a,{as:"h2"},"Finnish ",a," by product category (",o,")"),r.a.createElement("div",{id:"products-treemap-div",style:{width:"100%",height:"90%"}}))},re=function(e){var t=e.sitc2Data,a=e.year,o=Object(n.useState)("exports"),c=Object(A.a)(o,2),l=c[0],i=c[1];return void 0===t?r.a.createElement(C.a,{active:!0},r.a.createElement(D.a,null)):r.a.createElement(r.a.Fragment,null,r.a.createElement(W,{flow:l,setFlow:i}),r.a.createElement(ne,{sitc2Data:t,flow:l,year:a}))},oe=a(54),ce=a(551),le=function(e){var t=e.tradeBalance,a=e.darkModeActive,o=Object(n.useRef)(),c=t;return Object(n.useEffect)((function(){if(c){var e,t,a,n,r,l,i,s=40,u=40,d=80,m=40,p=20,f=10,v=20,h=10,g=oe.j().range(["#18447e","#A31E0F"]),y=["imports","exports"],b={imports:"Total value of goods imported to Finland",exports:"Total value of goods exported from Finland"},E=Math.max(oe.f(c.map((function(e){return e.imports}))),oe.f(c.map((function(e){return e.exports})))),x=oe.k("body").append("div").attr("class","d3-tooltip"),w=oe.k(o.current);A(),oe.k(window).on("resize",ce((function(){console.log("resizing"),A()}),800));var k=function(e,t){e.style("display","block"),e.html(t)},O=function(t){var a=e-oe.d.pageX>200?30:-220;t.style("left","".concat(oe.d.pageX+a,"px")).style("top","".concat(oe.d.pageY-65,"px"))}}function A(){console.log("drawing chart"),function(){e=Math.max(window.innerWidth,document.documentElement.clientWidth)-u-m,t=Math.max(window.innerHeight,document.documentElement.clientHeight)-s-d,a=e>=t?"horizontal":"vertical",console.log("".concat(e," x ").concat(t)),i&&i.remove();i=w.append("svg").attr("width",e+f+h).attr("height",t+p+v).attr("viewBox","0 0 ".concat(e+f+h," ").concat(t+p+v))}(),function(){var a=j(c);n=oe.h().domain(a.map((function(e){return e.year})).sort((function(e,t){return e-t}))).rangeRound([m,e-u]).paddingInner(.1),r=oe.h().domain(y).rangeRound([0,n.bandwidth()]).padding(.05),l=oe.i().domain([0,E]).nice().rangeRound([t-s,s])}(),i.append("g").call((function(e){return e.attr("transform","translate(0, ".concat(t-s+v,")")).call(oe.a(n).tickSize(0)).call((function(e){return e.select(".domain").remove()})).selectAll("text")})),i.append("g").call((function(e){return e.attr("transform","translate(".concat(m,", 0)")).call(oe.b(l).ticks(null,"s").tickSizeInner(0)).call((function(e){return e.select(".domain").remove()}))})),i.append("g").attr("class","grid").call(oe.b(l).tickSize(-e+u+m).tickFormat("")).attr("transform","translate(".concat(m+h,", 0)")),i.append("g").selectAll("g").data(j(c)).join("g").attr("transform",(function(e){return"translate(".concat(n(e.year)+h,", 0)")})).selectAll("rect").data((function(e){return y.map((function(t){return{key:t,value:e[t]}}))})).join("rect").attr("class","bar").attr("x",(function(e){return r(e.key)})).attr("width",r.bandwidth()).attr("y",(function(){return l(0)})).transition().ease(oe.c).duration(1500).attr("y",(function(e){return l(e.value)})).attr("height",(function(e){return l(0)-l(e.value)})).attr("fill",(function(e){return g(e.key)})),i.selectAll(".bar").on("mouseover",(function(e){oe.k(this).style("fill",oe.g(g(e.key)).darker(1))})).on("mouseout",(function(e){oe.k(this).style("fill",g(e.key))})).on("mouseover",(function(e){var t="\n          <div>\n            Total ".concat("imports"===e.key?"imports to":"exports from"," Finland:\n            <br>\n            ").concat(oe.e(",")(e.value),"\n          \u20ac</div>\n          ");k(x,t)})).on("mousemove",(function(){return O(x)})).on("mouseout",(function(){x.style("display","none")})),function(){if("vertical"===a)return void oe.k(".legend-wrapper").remove();var e=w.append("svg").attr("width",300).attr("height",30).attr("class","legend-wrapper").selectAll(".legend").data(y).enter().append("g").attr("class","legend").attr("transform",(function(e,t){return"translate(".concat(140*t,", 0)")}));e.append("rect").attr("x",0).attr("y",0).attr("width",30).attr("height",30).style("fill",(function(e){return g(e)})).on("mouseover",(function(e){var t="<div>".concat(b[e],"</div>");k(x,t)})).on("mousemove",(function(){return O(x)})).on("mouseout",(function(){x.style("display","none")})),e.append("text").attr("x",0).attr("y",0).attr("transform",(function(){return"translate(40, 20)"})).attr("class","d3-legend-text").text((function(e){return e.slice(0,1).toUpperCase()+e.slice(1)}))}(),console.log("chart ready")}function j(e){return"horizontal"===a?e:e.slice(0,4)}}),[c]),r.a.createElement("div",{className:a?"bar-chart dark-mode":"bar-chart",style:{width:"100%",height:"100vh",paddingTop:"3em",textAlign:"center"}},r.a.createElement(M.a,{as:"h2"},"Finnish Trade Balance"),r.a.createElement("div",{ref:o}))},ie=function(){var e=Object(O.b)(),t=Object(n.useState)(2019),a=Object(A.a)(t,2),o=a[0],c=a[1],l=Object(n.useState)([]),i=Object(A.a)(l,2),s=i[0],u=i[1],p=Object(n.useState)(""),f=Object(A.a)(p,2),h=f[0],g=f[1],y=Object(O.c)((function(e){return e})),E=y.tradeData,x=E.tradeBalance,w=y.isLoading;return Object(n.useEffect)((function(){e(function(){var e=Object(m.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t((function(e){e({type:"START_LOADING"})})),e.next=3,v();case 3:a=e.sent,t({type:"INIT_COUNTRYCODES",payload:a}),t((function(e){e({type:"FINISH_LOADING"})}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e(function(){var e=Object(m.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t((function(e){e({type:"START_LOADING"})})),e.next=3,b.getTradeBalance();case 3:a=e.sent,t({type:"INIT_TRADE_BALANCE_DATA",tradeBalance:a}),t((function(e){e({type:"FINISH_LOADING"})}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]),Object(n.useEffect)((function(){e(function(e){return function(){var t=Object(m.a)(d.a.mark((function t(a){var n,r,o;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a((function(e){e({type:"START_LOADING"})})),t.next=3,b.getExports(e);case 3:return n=t.sent,t.next=6,b.getImports(e);case 6:return r=t.sent,t.next=9,b.getSitc2Data(e,"total");case 9:o=t.sent,a({type:"INIT_TRADEDATA",exportsData:n,importsData:r,sitc2Data:o}),a((function(e){e({type:"FINISH_LOADING"})}));case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(o))}),[o,e]),r.a.createElement("div",{className:y.darkModeActive?"main-container dark-mode":"main-container"},r.a.createElement(T.a,{fluid:!0},r.a.createElement($,{year:o,setYear:c,darkModeActive:y.darkModeActive}),w&&r.a.createElement("div",{style:{height:"100vh"}},r.a.createElement(D.a,{active:!0})),!w&&r.a.createElement("div",null,r.a.createElement(I.a,{id:"trade-map"},r.a.createElement("section",{className:y.darkModeActive?"chart-section dark-mode":"chart-section"},r.a.createElement(V,{imports:E.importsData,exports:E.exportsData}),r.a.createElement("a",{href:"#trade-balance",className:"anchor-link"},r.a.createElement("div",{className:"arrow-down"})))),r.a.createElement(I.a,{id:"trade-balance"},r.a.createElement("section",{className:y.darkModeActive?"chart-section dark-mode":"chart-section"},r.a.createElement(le,{tradeBalance:x,darkModeActive:y.darkModeActive}),r.a.createElement("a",{href:"#imports-by-product",className:"anchor-link"},r.a.createElement("div",{className:"arrow-down"})))),r.a.createElement(I.a,{id:"imports-by-product"},r.a.createElement("section",{className:y.darkModeActive?"chart-section dark-mode":"chart-section"},r.a.createElement(re,{sitc2Data:E.sitc2Data,year:o}),r.a.createElement("a",{href:"#trade-partners",className:"anchor-link"},r.a.createElement("div",{className:"arrow-down"})))),r.a.createElement(I.a,{id:"trade-partners"},r.a.createElement("section",{className:y.darkModeActive?"chart-section dark-mode":"chart-section"},0===s.length&&r.a.createElement(z,{countryFilter:h,handleCountryFilterChange:function(e){g(e);var t=y.countryCodes.filter((function(t){return t.name===e}));u(t)},countryCodes:y.countryCodes}),0!==s.length&&r.a.createElement(_,{country:s[0],setCountry:u,setCountryFilter:g,year:o})))),r.a.createElement(Y,{darkModeActive:y.darkModeActive})))};c.a.render(r.a.createElement(O.a,{store:k},r.a.createElement(ie,null)),document.getElementById("root"))}},[[381,1,3]]]);
//# sourceMappingURL=main.9051eaec.chunk.js.map